const{json,isAdmin,loadState,saveState,pushLog}=require("./_state");exports.handler=async(event)=>{try{if(!isAdmin(event))return json(401,{error:"Unauthorized"});const body=JSON.parse(event.body || "{}");const teamId=String(body.teamId || "");const name=String(body.name || "").trim();if(!teamId)return json(400,{error:"Missing teamId"});if(!name)return json(400,{error:"Team name required"});const state=await loadState();state.teams=Array.isArray(state.teams)? state.teams:[];const t=state.teams.find(x=>x.id===teamId);if(!t)return json(404,{error:"Team not found"});const old=t.name;t.name=name;pushLog(state,`Team renamed:${old}â†’ ${name}`);await saveState(state);return json(200,{ok:true});}catch(e){console.error("renameTeam failed:",e);return json(500,{error:"Failed to rename team",detail:e?.message || "unknown"});}};