const{json,isAdmin}=require("./_state");const{isAdminAuthed}=require("./_adminGuard");const{loadInbox}=require("./_auth");exports.handler=async(e)=>{try{if(!(await isAdminAuthed(e,isAdmin)))return json(401,{error:"Unauthorized"});const i=await loadInbox();return json(200,{ok:true,items:(i.items||[]).slice(-300).reverse()});}catch(err){console.error("adminMessageHistory failed:",err);return json(500,{error:"Failed",detail:err?.message||"unknown"});}};